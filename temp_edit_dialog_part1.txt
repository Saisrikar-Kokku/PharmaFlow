            </Dialog>

            {/* Edit Sale Dialog */}
            <Dialog open={isEditDialogOpen} onOpenChange={setIsEditDialogOpen}>
                <DialogContent className="max-w-2xl glass-card">
                    <DialogHeader>
                        <DialogTitle className="text-2xl flex items-center gap-2">
                            <Pencil className="w-6 h-6 text-primary" />
                            Edit Sale
                        </DialogTitle>
                        <DialogDescription>
                            Update customer details, payment method, and item quantities
                        </DialogDescription>
                    </DialogHeader>
                    {editingSale && (
                        <div className="space-y-6 py-4">
                            {/* Customer Details */}
                            <div className="space-y-4">
                                <h3 className="font-semibold text-sm uppercase tracking-wide text-muted-foreground">Customer Details</h3>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <Label htmlFor="edit-customer-name">Customer Name</Label>
                                        <Input
                                            id="edit-customer-name"
                                            value={editCustomerName}
                                            onChange={(e) => setEditCustomerName(e.target.value)}
                                            placeholder="Walk-in"
                                        />
                                    </div>
                                    <div>
                                        <Label htmlFor="edit-customer-phone">Phone Number</Label>
                                        <Input
                                            id="edit-customer-phone"
                                            value={editCustomerPhone}
                                            onChange={(e) => setEditCustomerPhone(e.target.value)}
                                            placeholder="Optional"
                                        />
                                    </div>
                                </div>
                            </div>

                            {/* Payment Method */}
                            <div>
                                <Label htmlFor="edit-payment-method">Payment Method</Label>
                                <Select value={editPaymentMethod} onValueChange={setEditPaymentMethod}>
                                    <SelectTrigger id="edit-payment-method">
                                        <SelectValue />
                                    </SelectTrigger>
                                    <SelectContent>
                                        <SelectItem value="cash">Cash</SelectItem>
                                        <SelectItem value="card">Card</SelectItem>
                                        <SelectItem value="upi">UPI</SelectItem>
                                    </SelectContent>
                                </Select>
                            </div>

                            {/* Items */}
                            <div className="space-y-3">
                                <h3 className="font-semibold text-sm uppercase tracking-wide text-muted-foreground">Items Sold</h3>
                                {editItems.map((item, index) => {
                                    const saleItem = editingSale.sale_items.find(si => si.batch_id === item.id);
                                    return (
                                        <div key={item.id} className="flex items-center justify-between p-3 rounded-lg bg-accent/30 border border-border/50">
                                            <div>
                                                <p className="font-medium">{saleItem?.medicines?.name || 'Unknown'}</p>
                                                <p className="text-xs text-muted-foreground">â‚¹{saleItem?.unit_price.toFixed(2)} each</p>
                                            </div>
                                            <div className="flex items-center gap-3">
                                                <Button
                                                    variant="outline"
                                                    size="icon"
                                                    className="h-8 w-8"
                                                    onClick={() => {
                                                        const newItems = [...editItems];
                                                        if (newItems[index].quantity > 1) {
                                                            newItems[index].quantity--;
                                                            setEditItems(newItems);
                                                        }
                                                    }}
                                                >
                                                    <Minus className="w-4 h-4" />
                                                </Button>
                                                <span className="w-12 text-center font-semibold">{item.quantity}</span>
                                                <Button
                                                    variant="outline"
                                                    size="icon"
                                                    className="h-8 w-8"
                                                    onClick={() => {
                                                        const newItems = [...editItems];
                                                        newItems[index].quantity++;
                                                        setEditItems(newItems);
                                                    }}
                                                >
                                                    <Plus className="w-4 h-4" />
                                                </Button>
                                            </div>
                                        </div>
                                    );
                                })}
